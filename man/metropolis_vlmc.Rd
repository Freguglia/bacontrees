% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metropolis_vlmc.R
\name{metropolis_vlmc}
\alias{metropolis_vlmc}
\title{Metropolis-Hastings Posterior Sampling for Context Trees}
\usage{
metropolis_vlmc(
  data,
  n_steps,
  max_depth = 6,
  alpha = 0.001,
  context_weights = function(node) 0,
  burnin = 100,
  thin = 1,
  initial_root = TRUE
)
}
\arguments{
\item{data}{Either a character vector (single sequence) or a list of character vectors (multiple sequences).}

\item{n_steps}{Integer. Number of MCMC steps to run.}

\item{max_depth}{Integer. Maximum depth for the context tree.}

\item{alpha}{Numeric. Dirichlet prior parameter for transition probabilities.}

\item{context_weights}{Function. Returns the log prior weight for a given node.}

\item{burnin}{Integer. Number of initial iterations to discard from posterior summaries.}

\item{thin}{Integer. Thinning interval for posterior summaries.}

\item{initial_root}{Logical. If TRUE, start with root-only tree; if FALSE, start with maximal tree.}
}
\value{
An object of class \code{metropolis_vlmc} with elements:
\itemize{
\item \code{df}: Data frame of context sets, tree codes, counts, and posterior probabilities.
\item \code{codes}: List of context sets for each tree code.
\item \code{chain}: The full chain of tree codes sampled.
}
}
\description{
Runs the Metropolis-Hastings algorithm to sample from the posterior distribution of context trees given sequence data, Dirichlet priors, and context prior weights.
}
\details{
This function supports progress monitoring via the \strong{progressr} package. Wrap the call in \code{with_progress()} to display a progress bar.
}
\examples{
data(abc_list)
result <- metropolis_vlmc(abc_list, n_steps = 1000, max_depth = 3)
print(result)

}
